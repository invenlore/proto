flowchart TB
  subgraph Edge
    GW[api.gateway]
  end

  subgraph Core
    ID[identity]
    WR[wiki-write]
    RD[wiki-read]
    MED[media]
    RENDER[render worker]
    SRCH[search]
    IDX[search indexer]
  end

  subgraph Storage
    MONGO[(MongoDB)]
    REDIS[(Redis)]
    S3[(S3)]
    OS[(OpenSearch)]
  end

  GW --> ID
  GW --> WR
  GW --> RD
  GW --> MED
  GW --> SRCH

  ID --> MONGO
  WR --> MONGO
  RD --> MONGO
  MED --> MONGO
  RD --> REDIS
  GW --> REDIS

  MED --> S3
  RENDER --> MONGO
  IDX --> OS
  SRCH --> OS
